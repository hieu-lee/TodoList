@page "/"
@using TodoList.Models

<h1>Hello, world!</h1>
<div>
    <div style="display: flex; justify-content: space-between;">
        <div style="display: flex;">
            <img @onclick="AddNewItem" style="width: 30px; height: 30px; margin-left: 12px; margin-top: 12px; cursor: pointer;" src="add.png"/>
            <MudTextField T="string" FullWidth="true" Placeholder="Title" @bind-Value="@NewTitle" Style="margin: 0 10px;"></MudTextField>
        </div>
        <div style="margin-right: 12px; margin-top: 12px;">
            <img @onclick="ShowMore" src="more.png" style="width: 30px; height: 30px; cursor: pointer;" />
        </div>
    </div>
    <div>
        <span style="margin-right: 10px; margin-left: 15px;">Important</span><MudSwitch @bind-Checked="@NewImportant" Color="Color.Secondary" Style="margin-bottom: 0;" />
    </div>
    <div style="height: @ContentHeight; overflow-y: hidden; transition: height 0.5s;">
        <MudTextField Placeholder="Content" T="string" Variant="Variant.Outlined" @bind-Value="@NewContent" Lines="3" FullWidth="true" />
    </div>
</div>
<hr />
<ul>
    @foreach (var item in ImportantItems)
    {
        <li>
            <TodoItem item="item" list="list" ImportantItems="ImportantItems" CompletedItems="CompletedItems" UncompletedItems="UncompletedItems"></TodoItem>
            <hr />
        </li>
    }
</ul>
<ul>
    @foreach (var item in UncompletedItems)
    {
        <li>
            <TodoItem item="item" list="list" ImportantItems="ImportantItems" CompletedItems="CompletedItems" UncompletedItems="UncompletedItems"></TodoItem>
            <hr />
        </li>
    }
</ul>
<div style="display: flex; justify-content: space-between;">
    <h3>Completed Tasks</h3>
    <div style="margin-right: 12px; margin-top: 12px;">
        <img @onclick="ShowCompletedTasks" src="more.png" style="width: 30px; height: 30px; cursor: pointer;" />
    </div>
</div>
<div style="display: @CompletedDisplay">
    <ul>
        @foreach (var item in CompletedItems)
        {
            <li>
                <TodoItem item="item" list="list" ImportantItems="ImportantItems" CompletedItems="CompletedItems" UncompletedItems="UncompletedItems"></TodoItem>
                <hr />
            </li>
        }
    </ul>
</div>

Welcome to your new app.

<SurveyPrompt Title="How is Blazor working for you?" />

@code {
    bool NewImportant = false;
    string NewTitle = string.Empty;
    string NewContent = string.Empty;
    string ContentHeight = "0";
    string CompletedDisplay = "none";
    ToDoList list = new();
    HashSet<ToDoItem> UncompletedItems = new();
    HashSet<ToDoItem> CompletedItems = new();
    HashSet<ToDoItem> ImportantItems = new();

    private void ShowMore()
    {
        if (ContentHeight == "0")
        {
            ContentHeight = "100px";
        }
        else
        {
            ContentHeight = "0";
        }
    }

    private void ShowCompletedTasks()
    {
        if (CompletedDisplay == "none")
        {
            CompletedDisplay = "block";
        }
        else
        {
            CompletedDisplay = "none";
        }
    }

    private void ResetFields()
    {
        NewImportant = false;
        NewTitle = string.Empty;
        NewContent = string.Empty;
        ContentHeight = "0";
    }

    private void AddNewItem()
    {
        ToDoItem NewItem = new() { Content = NewContent, Title = NewTitle, TimeCreate = DateTime.Now, ListId = list.ListId, Important = NewImportant };
        list.Items.Add(NewItem);
        if (NewImportant)
        {
            ImportantItems.Add(NewItem);
        }
        else
        {
            UncompletedItems.Add(NewItem);
        }
        ResetFields();
    }
}
